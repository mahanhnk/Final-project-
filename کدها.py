# -*- coding: utf-8 -*-
"""Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ ÛŒØ§Ø¨ÛŒ ÙˆØ±Ø²Ø´ ÙˆÙˆØ´Ùˆ Ø¨Ø§ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1abc123xyz

# ğŸ¥‹ Ø³ÛŒØ³ØªÙ… Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ÛŒØ§Ø¨ÛŒ ÙˆØ±Ø²Ø´ ÙˆÙˆØ´Ùˆ Ø¨Ø§ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ

## Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²
"""

!pip install opencv-python mediapipe scikit-learn pandas numpy matplotlib seaborn streamlit pillow joblib
!pip install torch torchvision --index-url https://download.pytorch.org/whl/cpu
!pip install streamlit -q

import warnings
warnings.filterwarnings('ignore')

"""## 1. Ø¨Ø®Ø´ Ø§ÙˆÙ„: Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ØªÙ†ÛŒ"""

import pandas as pd
import numpy as np
from sklearn.ensemble import RandomForestClassifier
from sklearn.preprocessing import StandardScaler, LabelEncoder
from sklearn.model_selection import train_test_split
import joblib
import json
import os

class TextBasedWushuTalentAssessment:
    """
    Ú©Ù„Ø§Ø³ Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ ÙˆÙˆØ´Ùˆ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ØªÙ†ÛŒ
    """
    def __init__(self):
        self.model = None
        self.scaler = StandardScaler()
        self.label_encoder = LabelEncoder()
        self.feature_names = [
            'age', 'weight', 'height', 'flexibility', 'power', 
            'speed', 'endurance', 'balance', 'coordination',
            'reaction_time', 'mental_focus', 'competitive_spirit'
        ]
        
        # ÙˆØ²Ù† ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù…ØªÛŒØ§Ø²
        self.feature_weights = {
            'age': 0.10,
            'weight': 0.05,
            'height': 0.05,
            'flexibility': 0.15,
            'power': 0.12,
            'speed': 0.10,
            'endurance': 0.10,
            'balance': 0.08,
            'coordination': 0.08,
            'reaction_time': 0.07,
            'mental_focus': 0.05,
            'competitive_spirit': 0.05
        }
        
        # Ø³Ø¨Ú©â€ŒÙ‡Ø§ÛŒ ÙˆÙˆØ´Ùˆ
        self.styles = {
            0: 'ØªØ§Ù„Ùˆ (ÙØ±Ù…) - Ù…Ø¨ØªØ¯ÛŒ',
            1: 'ØªØ§Ù„Ùˆ (ÙØ±Ù…) - Ù¾ÛŒØ´Ø±ÙØªÙ‡',
            2: 'Ø³Ø§Ù†Ø¯Ø§ (Ù…Ø¨Ø§Ø±Ø²Ù‡) - Ø³Ø¨Ú©â€ŒÙˆØ²Ù†',
            3: 'Ø³Ø§Ù†Ø¯Ø§ (Ù…Ø¨Ø§Ø±Ø²Ù‡) - Ø³Ù†Ú¯ÛŒÙ†â€ŒÙˆØ²Ù†',
            4: 'ØªØ±Ú©ÛŒØ¨ÛŒ - Ù…Ù†Ø§Ø³Ø¨ Ù‡Ø± Ø¯Ùˆ Ø³Ø¨Ú©'
        }
        
    def create_sample_dataset(self, n_samples=1000):
        """
        Ø§ÛŒØ¬Ø§Ø¯ Ø¯ÛŒØªØ§Ø³Øª Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø±Ø§ÛŒ Ø¢Ù…ÙˆØ²Ø´ Ù…Ø¯Ù„
        """
        np.random.seed(42)
        
        data = []
        for i in range(n_samples):
            # ØªÙˆÙ„ÛŒØ¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªØµØ§Ø¯ÙÛŒ
            age = np.random.randint(8, 35)
            weight = np.random.uniform(30, 100)
            height = np.random.uniform(130, 195)
            
            # ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ ÙÛŒØ²ÛŒÚ©ÛŒ (Ù…Ù‚ÛŒØ§Ø³ 1-10)
            flexibility = np.random.randint(1, 11)
            power = np.random.randint(1, 11)
            speed = np.random.randint(1, 11)
            endurance = np.random.randint(1, 11)
            balance = np.random.randint(1, 11)
            coordination = np.random.randint(1, 11)
            reaction_time = np.random.randint(1, 11)
            
            # ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø°Ù‡Ù†ÛŒ
            mental_focus = np.random.randint(1, 11)
            competitive_spirit = np.random.randint(1, 11)
            
            # Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù…ØªÛŒØ§Ø² Ú©Ù„ÛŒ
            features = np.array([
                age, weight, height, flexibility, power, speed,
                endurance, balance, coordination, reaction_time,
                mental_focus, competitive_spirit
            ])
            
            # Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ø³Ù† Ø¨Ø±Ø§ÛŒ Ø§Ù…ØªÛŒØ§Ø²Ø¯Ù‡ÛŒ
            age_score = 10 - abs(age - 15) / 10  # Ø§ÙˆØ¬ Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø± 15 Ø³Ø§Ù„Ú¯ÛŒ
            
            # ØªØ¹ÛŒÛŒÙ† Ø³Ø¨Ú© Ø¨Ø± Ø§Ø³Ø§Ø³ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§
            if flexibility > 7 and balance > 6:
                if age < 18 and coordination > 7:
                    style = 1  # ØªØ§Ù„Ùˆ Ù¾ÛŒØ´Ø±ÙØªÙ‡
                else:
                    style = 0  # ØªØ§Ù„Ùˆ Ù…Ø¨ØªØ¯ÛŒ
            elif power > 7 and speed > 6:
                if weight < 70:
                    style = 2  # Ø³Ø§Ù†Ø¯Ø§ Ø³Ø¨Ú©â€ŒÙˆØ²Ù†
                else:
                    style = 3  # Ø³Ø§Ù†Ø¯Ø§ Ø³Ù†Ú¯ÛŒÙ†â€ŒÙˆØ²Ù†
            else:
                style = 4  # ØªØ±Ú©ÛŒØ¨ÛŒ
            
            data.append([
                age, weight, height, flexibility, power, speed,
                endurance, balance, coordination, reaction_time,
                mental_focus, competitive_spirit, style
            ])
        
        columns = self.feature_names + ['recommended_style']
        df = pd.DataFrame(data, columns=columns)
        return df
    
    def train_model(self, df=None):
        """
        Ø¢Ù…ÙˆØ²Ø´ Ù…Ø¯Ù„ Ø·Ø¨Ù‚Ù‡â€ŒØ¨Ù†Ø¯ÛŒ
        """
        if df is None:
            df = self.create_sample_dataset()
        
        X = df[self.feature_names]
        y = df['recommended_style']
        
        # Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯Ø³Ø§Ø²ÛŒ
        X_scaled = self.scaler.fit_transform(X)
        
        # Ø¢Ù…ÙˆØ²Ø´ Ù…Ø¯Ù„
        self.model = RandomForestClassifier(
            n_estimators=100,
            max_depth=10,
            random_state=42
        )
        self.model.fit(X_scaled, y)
        
        print("âœ… Ù…Ø¯Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¢Ù…ÙˆØ²Ø´ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯!")
        print(f"Ø¯Ù‚Øª Ù…Ø¯Ù„: {self.model.score(X_scaled, y):.2%}")
        return self.model
    
    def assess_talent(self, user_data):
        """
        Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø± Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ
        """
        if self.model is None:
            self.train_model()
        
        # ØªØ¨Ø¯ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ Ø¨Ù‡ Ø¢Ø±Ø§ÛŒÙ‡
        features = np.array([[
            user_data['age'],
            user_data['weight'],
            user_data['height'],
            user_data['flexibility'],
            user_data['power'],
            user_data['speed'],
            user_data['endurance'],
            user_data['balance'],
            user_data['coordination'],
            user_data['reaction_time'],
            user_data['mental_focus'],
            user_data['competitive_spirit']
        ]])
        
        # Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯Ø³Ø§Ø²ÛŒ
        features_scaled = self.scaler.transform(features)
        
        # Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø³Ø¨Ú©
        style_pred = self.model.predict(features_scaled)[0]
        style_prob = self.model.predict_proba(features_scaled)[0]
        
        # Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù…ØªÛŒØ§Ø² Ú©Ù„ÛŒ
        total_score = 0
        for i, feature in enumerate(self.feature_names):
            if feature in ['age', 'weight', 'height']:
                # Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¹Ø¯Ø¯ÛŒ
                if feature == 'age':
                    norm_value = 10 - abs(user_data[feature] - 15) / 10
                elif feature == 'weight':
                    norm_value = user_data[feature] / 100
                elif feature == 'height':
                    norm_value = user_data[feature] / 200
                total_score += norm_value * self.feature_weights[feature] * 10
            else:
                total_score += user_data[feature] * self.feature_weights[feature]
        
        # ØªÙˆÙ„ÛŒØ¯ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§
        recommendations = self._generate_recommendations(user_data, style_pred, total_score)
        
        return {
            'total_score': round(total_score, 2),
            'recommended_style': self.styles[style_pred],
            'style_confidence': round(max(style_prob) * 100, 2),
            'style_probabilities': {self.styles[i]: round(prob * 100, 2) for i, prob in enumerate(style_prob)},
            'strengths': recommendations['strengths'],
            'weaknesses': recommendations['weaknesses'],
            'training_recommendations': recommendations['training'],
            'detailed_analysis': self._detailed_analysis(user_data)
        }
    
    def _generate_recommendations(self, user_data, style_pred, total_score):
        """
        ØªÙˆÙ„ÛŒØ¯ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ø´Ø®ØµÛŒâ€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡
        """
        strengths = []
        weaknesses = []
        training_recs = []
        
        # ØªØ­Ù„ÛŒÙ„ Ù†Ù‚Ø§Ø· Ù‚ÙˆØª
        if user_data['flexibility'] >= 7:
            strengths.append("Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±ÛŒ Ø¹Ø§Ù„ÛŒ")
            training_recs.append("ØªÙ…Ø±ÛŒÙ†Ø§Øª Ø­ÙØ¸ Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±ÛŒ")
        else:
            weaknesses.append("Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±ÛŒ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¨Ù‡Ø¨ÙˆØ¯ Ø¯Ø§Ø±Ø¯")
            training_recs.append("ØªÙ…Ø±ÛŒÙ†Ø§Øª Ú©Ø´Ø´ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡")
        
        if user_data['balance'] >= 7:
            strengths.append("ØªØ¹Ø§Ø¯Ù„ Ø®ÙˆØ¨")
            training_recs.append("ØªÙ…Ø±ÛŒÙ†Ø§Øª ØªØ¹Ø§Ø¯Ù„ Ù¾ÛŒØ´Ø±ÙØªÙ‡")
        else:
            weaknesses.append("ØªØ¹Ø§Ø¯Ù„ Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªÙ‚ÙˆÛŒØª Ø¯Ø§Ø±Ø¯")
            training_recs.append("ØªÙ…Ø±ÛŒÙ†Ø§Øª ØªØ¹Ø§Ø¯Ù„ Ù¾Ø§ÛŒÙ‡")
        
        if user_data['power'] >= 7:
            strengths.append("Ù‚Ø¯Ø±Øª Ø¨Ø¯Ù†ÛŒ Ø¨Ø§Ù„Ø§")
        else:
            weaknesses.append("Ù‚Ø¯Ø±Øª Ø¨Ø¯Ù†ÛŒ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø§ÙØ²Ø§ÛŒØ´ Ø¯Ø§Ø±Ø¯")
            training_recs.append("ØªÙ…Ø±ÛŒÙ†Ø§Øª Ù‚Ø¯Ø±ØªÛŒ")
        
        # ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³Ø¨Ú©
        if style_pred in [0, 1]:  # ØªØ§Ù„Ùˆ
            training_recs.extend([
                "ØªÙ…Ø±ÛŒÙ† ÙØ±Ù…â€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡ ÙˆÙˆØ´Ùˆ",
                "Ú©Ø§Ø± Ø¨Ø± Ø±ÙˆÛŒ Ø¯Ù‚Øª Ø­Ø±Ú©Ø§Øª",
                "ØªÙ…Ø±ÛŒÙ†Ø§Øª Ù†Ù…Ø§ÛŒØ´ÛŒ"
            ])
        elif style_pred in [2, 3]:  # Ø³Ø§Ù†Ø¯Ø§
            training_recs.extend([
                "ØªÙ…Ø±ÛŒÙ†Ø§Øª Ù…Ø¨Ø§Ø±Ø²Ù‡ Ø¨Ø§ Ø´Ø±ÛŒÚ©",
                "Ú©Ø§Ø± Ø¨Ø± Ø±ÙˆÛŒ ØªÚ©Ù†ÛŒÚ©â€ŒÙ‡Ø§ÛŒ Ø¶Ø±Ø¨Ù‡ Ùˆ Ø¯ÙØ§Ø¹",
                "ØªÙ…Ø±ÛŒÙ†Ø§Øª Ø§Ø³ØªÙ‚Ø§Ù…ØªÛŒ"
            ])
        else:  # ØªØ±Ú©ÛŒØ¨ÛŒ
            training_recs.extend([
                "ØªÙ…Ø±ÛŒÙ†Ø§Øª Ù…ØªÙ†ÙˆØ¹ Ø§Ø² Ù‡Ø± Ø¯Ùˆ Ø³Ø¨Ú©",
                "ØªÙˆØ³Ø¹Ù‡ Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡",
                "Ú©Ø§Ø± Ø¨Ø± Ø±ÙˆÛŒ Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù"
            ])
        
        return {
            'strengths': strengths,
            'weaknesses': weaknesses,
            'training': list(set(training_recs))
        }
    
    def _detailed_analysis(self, user_data):
        """
        ØªØ­Ù„ÛŒÙ„ Ø¬Ø²Ø¦ÛŒ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§
        """
        analysis = {}
        
        # ØªØ­Ù„ÛŒÙ„ Ø³Ù†
        age = user_data['age']
        if age < 12:
            analysis['age'] = "Ø³Ù† Ù¾Ø§ÛŒÛŒÙ† - Ø²Ù…Ø§Ù† Ø¹Ø§Ù„ÛŒ Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ø¢Ù…ÙˆØ²Ø´ Ù¾Ø§ÛŒÙ‡"
        elif 12 <= age <= 18:
            analysis['age'] = "Ø³Ù† Ø§ÛŒØ¯Ù‡â€ŒØ¢Ù„ Ø¨Ø±Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡ Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ ØªØ®ØµØµÛŒ"
        elif 19 <= age <= 25:
            analysis['age'] = "Ø³Ù† Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ø±Ù‚Ø§Ø¨Øªâ€ŒÙ‡Ø§ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ"
        else:
            analysis['age'] = "Ø³Ù† Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ ØªÙ…Ø±ÛŒÙ†Ø§Øª ØªÙØ±ÛŒØ­ÛŒ Ùˆ Ø³Ù„Ø§Ù…ØªÛŒ"
        
        # ØªØ­Ù„ÛŒÙ„ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ ÙÛŒØ²ÛŒÚ©ÛŒ
        for feature in ['flexibility', 'power', 'speed', 'endurance', 'balance']:
            value = user_data[feature]
            if value >= 8:
                analysis[feature] = "Ø¹Ø§Ù„ÛŒ"
            elif value >= 6:
                analysis[feature] = "Ø®ÙˆØ¨"
            elif value >= 4:
                analysis[feature] = "Ù…ØªÙˆØ³Ø·"
            else:
                analysis[feature] = "Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¨Ù‡Ø¨ÙˆØ¯"
        
        return analysis
    
    def save_model(self, path='wushu_text_model.joblib'):
        """
        Ø°Ø®ÛŒØ±Ù‡ Ù…Ø¯Ù„ Ø¢Ù…ÙˆØ²Ø´ Ø¯ÛŒØ¯Ù‡
        """
        if self.model:
            joblib.dump({
                'model': self.model,
                'scaler': self.scaler,
                'feature_names': self.feature_names,
                'styles': self.styles
            }, path)
            print(f"âœ… Ù…Ø¯Ù„ Ø¯Ø± {path} Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯.")
    
    def load_model(self, path='wushu_text_model.joblib'):
        """
        Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø¯Ù„ Ø§Ø² ÙØ§ÛŒÙ„
        """
        if os.path.exists(path):
            data = joblib.load(path)
            self.model = data['model']
            self.scaler = data['scaler']
            self.feature_names = data['feature_names']
            self.styles = data['styles']
            print("âœ… Ù…Ø¯Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯.")
        else:
            print("âš ï¸ ÙØ§ÛŒÙ„ Ù…Ø¯Ù„ ÛŒØ§ÙØª Ù†Ø´Ø¯. Ù…Ø¯Ù„ Ø¬Ø¯ÛŒØ¯ Ø¢Ù…ÙˆØ²Ø´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.")
            self.train_model()

"""### ØªØ³Øª Ø¨Ø®Ø´ Ù…ØªÙ†ÛŒ"""

# Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø² Ú©Ù„Ø§Ø³ Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ
text_assessor = TextBasedWushuTalentAssessment()

# Ø¢Ù…ÙˆØ²Ø´ Ù…Ø¯Ù„
print("Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù…ÙˆØ²Ø´ Ù…Ø¯Ù„ Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ù…ØªÙ†ÛŒ...")
text_assessor.train_model()

# ØªØ³Øª Ø¨Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ú©Ø§Ø±Ø¨Ø±
test_user = {
    'age': 16,
    'weight': 65,
    'height': 175,
    'flexibility': 8,
    'power': 7,
    'speed': 8,
    'endurance': 6,
    'balance': 9,
    'coordination': 8,
    'reaction_time': 7,
    'mental_focus': 8,
    'competitive_spirit': 9
}

print("\nğŸ” Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ ÙˆØ±Ø²Ø´Ú©Ø§Ø±...")
result = text_assessor.assess_talent(test_user)

print(f"\nğŸ¯ Ù†ØªØ§ÛŒØ¬ Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ:")
print(f"Ø§Ù…ØªÛŒØ§Ø² Ú©Ù„ÛŒ: {result['total_score']}/100")
print(f"Ø³Ø¨Ú© ØªÙˆØµÛŒÙ‡ Ø´Ø¯Ù‡: {result['recommended_style']}")
print(f"Ù‚Ø·Ø¹ÛŒØª Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ: {result['style_confidence']}%")

print(f"\nâœ… Ù†Ù‚Ø§Ø· Ù‚ÙˆØª:")
for strength in result['strengths']:
    print(f"  - {strength}")

print(f"\nğŸ“ Ù†ÛŒØ§Ø²Ù‡Ø§ÛŒ Ø¨Ù‡Ø¨ÙˆØ¯:")
for weakness in result['weaknesses']:
    print(f"  - {weakness}")

print(f"\nğŸ’ª ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§ÛŒ ØªÙ…Ø±ÛŒÙ†ÛŒ:")
for rec in result['training_recommendations'][:5]:
    print(f"  - {rec}")

"""## 2. Ø¨Ø®Ø´ Ø¯ÙˆÙ…: ØªØ­Ù„ÛŒÙ„ Pose Detection"""

import cv2
import mediapipe as mp
import numpy as np
from IPython.display import Image, display
import matplotlib.pyplot as plt
from google.colab.patches import cv2_imshow
import math

class WushuPoseAnalyzer:
    """
    Ú©Ù„Ø§Ø³ ØªØ­Ù„ÛŒÙ„ ÙØ±Ù… Ø¨Ø¯Ù† Ùˆ Ø­Ø±Ú©Ø§Øª ÙˆÙˆØ´Ùˆ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² MediaPipe
    """
    def __init__(self):
        self.mp_pose = mp.solutions.pose
        self.pose = self.mp_pose.Pose(
            static_image_mode=False,
            model_complexity=1,
            smooth_landmarks=True,
            min_detection_confidence=0.5,
            min_tracking_confidence=0.5
        )
        self.mp_drawing = mp.solutions.drawing_utils
        
        # ØªØ¹Ø±ÛŒÙ Ù†Ù‚Ø§Ø· Ú©Ù„ÛŒØ¯ÛŒ Ø¨Ø±Ø§ÛŒ ÙˆÙˆØ´Ùˆ
        self.key_points = {
            'nose': 0,
            'left_shoulder': 11,
            'right_shoulder': 12,
            'left_elbow': 13,
            'right_elbow': 14,
            'left_wrist': 15,
            'right_wrist': 16,
            'left_hip': 23,
            'right_hip': 24,
            'left_knee': 25,
            'right_knee': 26,
            'left_ankle': 27,
            'right_ankle': 28
        }
        
    def calculate_angle(self, a, b, c):
        """
        Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø²Ø§ÙˆÛŒÙ‡ Ø¨ÛŒÙ† Ø³Ù‡ Ù†Ù‚Ø·Ù‡
        """
        a = np.array(a)
        b = np.array(b)
        c = np.array(c)
        
        radians = np.arctan2(c[1]-b[1], c[0]-b[0]) - np.arctan2(a[1]-b[1], a[0]-b[0])
        angle = np.abs(radians*180.0/np.pi)
        
        if angle > 180.0:
            angle = 360 - angle
            
        return angle
    
    def analyze_image(self, image_path):
        """
        ØªØ­Ù„ÛŒÙ„ ÙØ±Ù… Ø¨Ø¯Ù† Ø§Ø² ÛŒÚ© ØªØµÙˆÛŒØ±
        """
        # Ø®ÙˆØ§Ù†Ø¯Ù† ØªØµÙˆÛŒØ±
        image = cv2.imread(image_path)
        if image is None:
            print(f"âš ï¸ ØªØµÙˆÛŒØ± {image_path} ÛŒØ§ÙØª Ù†Ø´Ø¯!")
            return None
        
        image_rgb = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)
        results = self.pose.process(image_rgb)
        
        if not results.pose_landmarks:
            print("âŒ Ù‡ÛŒÚ† ÙØ±Ù… Ø¨Ø¯Ù†ÛŒ ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø¯Ù‡ Ù†Ø´Ø¯!")
            return None
        
        # Ø±Ø³Ù… Ù†Ù‚Ø§Ø· Ú©Ù„ÛŒØ¯ÛŒ Ø±ÙˆÛŒ ØªØµÙˆÛŒØ±
        annotated_image = image.copy()
        self.mp_drawing.draw_landmarks(
            annotated_image,
            results.pose_landmarks,
            self.mp_pose.POSE_CONNECTIONS,
            landmark_drawing_spec=self.mp_drawing.DrawingSpec(color=(0, 255, 0), thickness=2, circle_radius=2),
            connection_drawing_spec=self.mp_drawing.DrawingSpec(color=(255, 0, 0), thickness=2)
        )
        
        # Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†Ù‚Ø§Ø· Ú©Ù„ÛŒØ¯ÛŒ
        landmarks = results.pose_landmarks.landmark
        h, w, _ = image.shape
        
        key_positions = {}
        for name, idx in self.key_points.items():
            landmark = landmarks[idx]
            key_positions[name] = (int(landmark.x * w), int(landmark.y * h))
        
        # ØªØ­Ù„ÛŒÙ„ ÙØ±Ù…
        analysis = self._analyze_posture(key_positions)
        
        # Ù†Ù…Ø§ÛŒØ´ ØªØµÙˆÛŒØ±
        plt.figure(figsize=(10, 10))
        plt.imshow(cv2.cvtColor(annotated_image, cv2.COLOR_BGR2RGB))
        plt.title("ØªØ­Ù„ÛŒÙ„ ÙØ±Ù… Ø¨Ø¯Ù† - ÙˆÙˆØ´Ùˆ")
        plt.axis('off')
        plt.show()
        
        return analysis
    
    def analyze_video(self, video_path, output_path='analyzed_video.mp4'):
        """
        ØªØ­Ù„ÛŒÙ„ ÙØ±Ù… Ø¨Ø¯Ù† Ø§Ø² ÙˆÛŒØ¯Ø¦Ùˆ
        """
        cap = cv2.VideoCapture(video_path)
        
        if not cap.isOpened():
            print(f"âš ï¸ ÙˆÛŒØ¯Ø¦Ùˆ {video_path} ÛŒØ§ÙØª Ù†Ø´Ø¯!")
            return None
        
        # Ù…Ø´Ø®ØµØ§Øª ÙˆÛŒØ¯Ø¦Ùˆ
        fps = int(cap.get(cv2.CAP_PROP_FPS))
        width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))
        height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))
        
        # ØªØ¹Ø±ÛŒÙ Ú©Ø¯Ú© Ùˆ Ø®Ø±ÙˆØ¬ÛŒ
        fourcc = cv2.VideoWriter_fourcc(*'mp4v')
        out = cv2.VideoWriter(output_path, fourcc, fps, (width, height))
        
        frame_analyses = []
        frame_count = 0
        
        print("ğŸ¬ Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„ ÙˆÛŒØ¯Ø¦Ùˆ...")
        
        while cap.isOpened():
            ret, frame = cap.read()
            
            if not ret:
                break
            
            frame_count += 1
            if frame_count % 30 == 0:
                print(f"ğŸ“Š ØªØ­Ù„ÛŒÙ„ ÙØ±ÛŒÙ… {frame_count}...")
            
            # Ù¾Ø±Ø¯Ø§Ø²Ø´ ÙØ±ÛŒÙ…
            frame_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
            results = self.pose.process(frame_rgb)
            
            annotated_frame = frame.copy()
            
            if results.pose_landmarks:
                # Ø±Ø³Ù… Ù†Ù‚Ø§Ø· Ú©Ù„ÛŒØ¯ÛŒ
                self.mp_drawing.draw_landmarks(
                    annotated_frame,
                    results.pose_landmarks,
                    self.mp_pose.POSE_CONNECTIONS
                )
                
                # Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ùˆ ØªØ­Ù„ÛŒÙ„ Ù†Ù‚Ø§Ø·
                landmarks = results.pose_landmarks.landmark
                key_positions = {}
                
                for name, idx in self.key_points.items():
                    landmark = landmarks[idx]
                    key_positions[name] = (int(landmark.x * width), int(landmark.y * height))
                
                # ØªØ­Ù„ÛŒÙ„ ÙØ±Ù… Ø§ÛŒÙ† ÙØ±ÛŒÙ…
                frame_analysis = self._analyze_posture(key_positions)
                frame_analyses.append(frame_analysis)
                
                # Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø±ÙˆÛŒ ÙˆÛŒØ¯Ø¦Ùˆ
                cv2.putText(annotated_frame, f"Balance: {frame_analysis['balance_score']:.1f}", 
                           (50, 50), cv2.FONT_HERSHEY_SIMPLEX, 1, (0, 255, 0), 2)
                cv2.putText(annotated_frame, f"Flexibility: {frame_analysis['flexibility_score']:.1f}", 
                           (50, 100), cv2.FONT_HERSHEY_SIMPLEX, 1, (0, 255, 255), 2)
                cv2.putText(annotated_frame, f"Style: {frame_analysis['recommended_style']}", 
                           (50, 150), cv2.FONT_HERSHEY_SIMPLEX, 1, (255, 0, 0), 2)
            
            out.write(annotated_frame)
        
        cap.release()
        out.release()
        print(f"âœ… ÙˆÛŒØ¯Ø¦Ùˆ ØªØ­Ù„ÛŒÙ„ Ø´Ø¯Ù‡ Ø¯Ø± {output_path} Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯.")
        
        # ØªØ­Ù„ÛŒÙ„ Ú©Ù„ÛŒ ÙˆÛŒØ¯Ø¦Ùˆ
        if frame_analyses:
            video_analysis = self._aggregate_video_analysis(frame_analyses)
            return video_analysis
        
        return None
    
    def _analyze_posture(self, key_positions):
        """
        ØªØ­Ù„ÛŒÙ„ ÙØ±Ù… Ø¨Ø¯Ù† Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†Ù‚Ø§Ø· Ú©Ù„ÛŒØ¯ÛŒ
        """
        analysis = {}
        
        # Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø²ÙˆØ§ÛŒØ§
        try:
            # Ø²Ø§ÙˆÛŒÙ‡ Ø²Ø§Ù†Ùˆ (Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ ØªØ¹Ø§Ø¯Ù„)
            if all(k in key_positions for k in ['left_hip', 'left_knee', 'left_ankle']):
                left_knee_angle = self.calculate_angle(
                    key_positions['left_hip'],
                    key_positions['left_knee'],
                    key_positions['left_ankle']
                )
                analysis['left_knee_angle'] = left_knee_angle
            else:
                left_knee_angle = 170  # Ù…Ù‚Ø¯Ø§Ø± Ù¾ÛŒØ´â€ŒÙØ±Ø¶
            
            if all(k in key_positions for k in ['right_hip', 'right_knee', 'right_ankle']):
                right_knee_angle = self.calculate_angle(
                    key_positions['right_hip'],
                    key_positions['right_knee'],
                    key_positions['right_ankle']
                )
                analysis['right_knee_angle'] = right_knee_angle
            else:
                right_knee_angle = 170
            
            # Ø²Ø§ÙˆÛŒÙ‡ Ø¢Ø±Ù†Ø¬ (Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù‚Ø¯Ø±Øª)
            if all(k in key_positions for k in ['left_shoulder', 'left_elbow', 'left_wrist']):
                left_elbow_angle = self.calculate_angle(
                    key_positions['left_shoulder'],
                    key_positions['left_elbow'],
                    key_positions['left_wrist']
                )
                analysis['left_elbow_angle'] = left_elbow_angle
            else:
                left_elbow_angle = 160
            
            # ØªØ­Ù„ÛŒÙ„ ØªØ¹Ø§Ø¯Ù„
            balance_score = 100 - abs(left_knee_angle - right_knee_angle) * 2
            balance_score = max(0, min(100, balance_score))
            analysis['balance_score'] = balance_score
            
            # ØªØ­Ù„ÛŒÙ„ Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±ÛŒ
            avg_knee_angle = (left_knee_angle + right_knee_angle) / 2
            flexibility_score = max(0, min(100, (180 - avg_knee_angle) * 2))
            analysis['flexibility_score'] = flexibility_score
            
            # ØªØ­Ù„ÛŒÙ„ Ù‚Ø¯Ø±Øª
            power_score = min(100, left_elbow_angle * 0.5)
            analysis['power_score'] = power_score
            
            # ØªØ­Ù„ÛŒÙ„ Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ
            shoulder_diff = abs(key_positions.get('left_shoulder', (0, 0))[1] - 
                              key_positions.get('right_shoulder', (0, 0))[1])
            hip_diff = abs(key_positions.get('left_hip', (0, 0))[1] - 
                          key_positions.get('right_hip', (0, 0))[1])
            
            coordination_score = 100 - (shoulder_diff + hip_diff)
            coordination_score = max(0, min(100, coordination_score))
            analysis['coordination_score'] = coordination_score
            
            # ØªØ´Ø®ÛŒØµ Ø³Ø¨Ú© Ù…Ù†Ø§Ø³Ø¨
            if flexibility_score > 70 and balance_score > 75:
                if coordination_score > 80:
                    recommended_style = "ØªØ§Ù„Ùˆ (ÙØ±Ù…) - Ù¾ÛŒØ´Ø±ÙØªÙ‡"
                    style_points = 4
                else:
                    recommended_style = "ØªØ§Ù„Ùˆ (ÙØ±Ù…) - Ù…Ø¨ØªØ¯ÛŒ"
                    style_points = 3
            elif power_score > 65 and balance_score > 70:
                # ØªØ´Ø®ÛŒØµ ÙˆØ²Ù† Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†Ø³Ø¨Øª Ù‚Ø¯ Ùˆ ÙˆØ²Ù† (ØªØ®Ù…ÛŒÙ†ÛŒ)
                shoulder_width = abs(key_positions.get('left_shoulder', (0, 0))[0] - 
                                   key_positions.get('right_shoulder', (0, 0))[0])
                if shoulder_width > 100:  # ØªØ®Ù…ÛŒÙ†ÛŒ
                    recommended_style = "Ø³Ø§Ù†Ø¯Ø§ (Ù…Ø¨Ø§Ø±Ø²Ù‡) - Ø³Ù†Ú¯ÛŒÙ†â€ŒÙˆØ²Ù†"
                    style_points = 2
                else:
                    recommended_style = "Ø³Ø§Ù†Ø¯Ø§ (Ù…Ø¨Ø§Ø±Ø²Ù‡) - Ø³Ø¨Ú©â€ŒÙˆØ²Ù†"
                    style_points = 1
            else:
                recommended_style = "ØªØ±Ú©ÛŒØ¨ÛŒ - Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªÙ…Ø±ÛŒÙ† Ø¨ÛŒØ´ØªØ±"
                style_points = 0
            
            analysis['recommended_style'] = recommended_style
            analysis['style_points'] = style_points
            
            # Ø§Ù…ØªÛŒØ§Ø² Ú©Ù„ÛŒ
            overall_score = (
                balance_score * 0.3 +
                flexibility_score * 0.25 +
                power_score * 0.2 +
                coordination_score * 0.25
            )
            analysis['overall_score'] = overall_score
            
            # Ù†Ù‚Ø§Ø· Ù‚ÙˆØª Ùˆ Ø¶Ø¹Ù
            strengths = []
            weaknesses = []
            
            if balance_score > 80:
                strengths.append("ØªØ¹Ø§Ø¯Ù„ Ø¹Ø§Ù„ÛŒ")
            elif balance_score < 60:
                weaknesses.append("ØªØ¹Ø§Ø¯Ù„ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¨Ù‡Ø¨ÙˆØ¯ Ø¯Ø§Ø±Ø¯")
            
            if flexibility_score > 75:
                strengths.append("Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±ÛŒ Ø®ÙˆØ¨")
            elif flexibility_score < 50:
                weaknesses.append("Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±ÛŒ Ù…Ø­Ø¯ÙˆØ¯")
            
            if power_score > 70:
                strengths.append("Ù‚Ø¯Ø±Øª Ø¨Ø¯Ù†ÛŒ Ù…Ù†Ø§Ø³Ø¨")
            
            analysis['strengths'] = strengths
            analysis['weaknesses'] = weaknesses
            
        except Exception as e:
            print(f"Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ ÙØ±Ù…: {e}")
            return None
        
        return analysis
    
    def _aggregate_video_analysis(self, frame_analyses):
        """
        ØªØ¬Ù…ÛŒØ¹ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ÙØ±ÛŒÙ…â€ŒÙ‡Ø§ÛŒ ÙˆÛŒØ¯Ø¦Ùˆ
        """
        if not frame_analyses:
            return None
        
        # Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ú¯Ø±ÙØªÙ† Ø§Ø² Ø§Ù…ØªÛŒØ§Ø²Ù‡Ø§
        avg_scores = {
            'balance_score': np.mean([f.get('balance_score', 0) for f in frame_analyses]),
            'flexibility_score': np.mean([f.get('flexibility_score', 0) for f in frame_analyses]),
            'power_score': np.mean([f.get('power_score', 0) for f in frame_analyses]),
            'coordination_score': np.mean([f.get('coordination_score', 0) for f in frame_analyses]),
            'overall_score': np.mean([f.get('overall_score', 0) for f in frame_analyses])
        }
        
        # ØªØ´Ø®ÛŒØµ Ø³Ø¨Ú© ØºØ§Ù„Ø¨
        style_counts = {}
        for f in frame_analyses:
            style = f.get('recommended_style', '')
            if style:
                style_counts[style] = style_counts.get(style, 0) + 1
        
        if style_counts:
            dominant_style = max(style_counts, key=style_counts.get)
        else:
            dominant_style = "ØªØ¹ÛŒÛŒÙ† Ù†Ø´Ø¯"
        
        # Ø¬Ù…Ø¹â€ŒØ¨Ù†Ø¯ÛŒ Ù†Ù‚Ø§Ø· Ù‚ÙˆØª Ùˆ Ø¶Ø¹Ù
        all_strengths = []
        all_weaknesses = []
        
        for f in frame_analyses:
            all_strengths.extend(f.get('strengths', []))
            all_weaknesses.extend(f.get('weaknesses', []))
        
        common_strengths = list(set([s for s in all_strengths 
                                   if all_strengths.count(s) > len(frame_analyses) * 0.3]))
        common_weaknesses = list(set([w for w in all_weaknesses 
                                    if all_weaknesses.count(w) > len(frame_analyses) * 0.3]))
        
        return {
            'average_scores': avg_scores,
            'dominant_style': dominant_style,
            'common_strengths': common_strengths,
            'common_weaknesses': common_weaknesses,
            'frame_count': len(frame_analyses),
            'consistency': np.std([f.get('overall_score', 0) for f in frame_analyses])
        }
    
    def generate_pose_report(self, image_path=None, video_path=None):
        """
        ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´ Ú©Ø§Ù…Ù„ Ø§Ø² ØªØ­Ù„ÛŒÙ„ ÙØ±Ù…
        """
        analysis = None
        
        if image_path:
            print(f"ğŸ“· ØªØ­Ù„ÛŒÙ„ ØªØµÙˆÛŒØ±: {image_path}")
            analysis = self.analyze_image(image_path)
        elif video_path:
            print(f"ğŸ¥ ØªØ­Ù„ÛŒÙ„ ÙˆÛŒØ¯Ø¦Ùˆ: {video_path}")
            analysis = self.analyze_video(video_path)
        else:
            print("âš ï¸ Ù„Ø·ÙØ§ Ù…Ø³ÛŒØ± ØªØµÙˆÛŒØ± ÛŒØ§ ÙˆÛŒØ¯Ø¦Ùˆ Ø±Ø§ Ù…Ø´Ø®Øµ Ú©Ù†ÛŒØ¯.")
            return
        
        if analysis:
            print("\nğŸ“Š Ú¯Ø²Ø§Ø±Ø´ ØªØ­Ù„ÛŒÙ„ ÙØ±Ù… Ø¨Ø¯Ù†ÛŒ:")
            print("=" * 50)
            
            if 'average_scores' in analysis:  # ÙˆÛŒØ¯Ø¦Ùˆ
                scores = analysis['average_scores']
                print(f"\nğŸ¯ Ø§Ù…ØªÛŒØ§Ø²Ù‡Ø§ÛŒ Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†:")
                for key, value in scores.items():
                    print(f"  {key}: {value:.1f}/100")
                
                print(f"\nğŸ¥‹ Ø³Ø¨Ú© ØºØ§Ù„Ø¨: {analysis['dominant_style']}")
                print(f"ğŸ“ˆ ØªØ¹Ø¯Ø§Ø¯ ÙØ±ÛŒÙ…â€ŒÙ‡Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ø´Ø¯Ù‡: {analysis['frame_count']}")
                print(f"ğŸ­ Ø«Ø¨Ø§Øª Ø¹Ù…Ù„Ú©Ø±Ø¯: {analysis['consistency']:.2f}")
                
            else:  # ØªØµÙˆÛŒØ±
                print(f"\nğŸ¯ Ø§Ù…ØªÛŒØ§Ø²Ù‡Ø§:")
                for key, value in analysis.items():
                    if 'score' in key or 'angle' in key:
                        if 'score' in key:
                            print(f"  {key}: {value:.1f}/100")
                        else:
                            print(f"  {key}: {value:.1f}Â°")
                
                print(f"\nğŸ¥‹ Ø³Ø¨Ú© ØªÙˆØµÛŒÙ‡ Ø´Ø¯Ù‡: {analysis.get('recommended_style', 'ØªØ¹ÛŒÛŒÙ† Ù†Ø´Ø¯')}")
            
            if 'strengths' in analysis and analysis['strengths']:
                print(f"\nâœ… Ù†Ù‚Ø§Ø· Ù‚ÙˆØª ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡:")
                for strength in analysis['strengths']:
                    print(f"  - {strength}")
            
            if 'weaknesses' in analysis and analysis['weaknesses']:
                print(f"\nğŸ“ Ù†Ù‚Ø§Ø· Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ Ø¨Ù‡Ø¨ÙˆØ¯:")
                for weakness in analysis['weaknesses']:
                    print(f"  - {weakness}")
            
            print("\nğŸ’¡ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§:")
            if analysis.get('flexibility_score', 0) < 60:
                print("  - ØªÙ…Ø±ÛŒÙ†Ø§Øª Ú©Ø´Ø´ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡ Ø±Ø§ Ø§ÙØ²Ø§ÛŒØ´ Ø¯Ù‡ÛŒØ¯")
            if analysis.get('balance_score', 0) < 65:
                print("  - Ø±ÙˆÛŒ ØªÙ…Ø±ÛŒÙ†Ø§Øª ØªØ¹Ø§Ø¯Ù„ Ù…Ø§Ù†Ù†Ø¯ Ø§ÛŒØ³ØªØ§Ø¯Ù† Ø±ÙˆÛŒ ÛŒÚ© Ù¾Ø§ Ú©Ø§Ø± Ú©Ù†ÛŒØ¯")
            if analysis.get('power_score', 0) < 50:
                print("  - ØªÙ…Ø±ÛŒÙ†Ø§Øª Ù‚Ø¯Ø±ØªÛŒ Ù¾Ø§ÛŒÙ‡â€ŒØ§ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯")
            
            print("=" * 50)
            
        return analysis

"""### ØªØ³Øª Pose Detection"""

# Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆÙ†Ù‡ ØªØ­Ù„ÛŒÙ„â€ŒÚ¯Ø±
pose_analyzer = WushuPoseAnalyzer()

print("ğŸ”„ ØªØ­Ù„ÛŒÙ„â€ŒÚ¯Ø± Pose Detection Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª.")

# ØªØ³Øª Ø¨Ø§ ÛŒÚ© ØªØµÙˆÛŒØ± Ù†Ù…ÙˆÙ†Ù‡ (Ø§Ú¯Ø± ØªØµÙˆÛŒØ±ÛŒ Ø¯Ø± Colab Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯)
# Ø¨Ø±Ø§ÛŒ ØªØ³ØªØŒ Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© ØªØµÙˆÛŒØ± Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯:
from google.colab import files

print("ğŸ“¤ Ù„Ø·ÙØ§ ÛŒÚ© ØªØµÙˆÛŒØ± Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯...")
uploaded = files.upload()

if uploaded:
    image_name = list(uploaded.keys())[0]
    print(f"âœ… ØªØµÙˆÛŒØ± {image_name} Ø¢Ù¾Ù„ÙˆØ¯ Ø´Ø¯.")
    
    # ØªØ­Ù„ÛŒÙ„ ØªØµÙˆÛŒØ±
    pose_analysis = pose_analyzer.generate_pose_report(image_path=image_name)
else:
    print("âš ï¸ Ù‡ÛŒÚ† ØªØµÙˆÛŒØ±ÛŒ Ø¢Ù¾Ù„ÙˆØ¯ Ù†Ø´Ø¯. Ø§Ø¯Ø§Ù…Ù‡ Ø¨Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡...")
    
    # Ø§ÛŒØ¬Ø§Ø¯ ÛŒÚ© ØªØµÙˆÛŒØ± Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø§ OpenCV
    sample_image = np.zeros((400, 400, 3), dtype=np.uint8)
    cv2.putText(sample_image, "ØªØµÙˆÛŒØ± Ù†Ù…ÙˆÙ†Ù‡ ÙˆÙˆØ´Ùˆ", (50, 200), 
                cv2.FONT_HERSHEY_SIMPLEX, 1, (255, 255, 255), 2)
    
    cv2.imwrite('sample_wushu.jpg', sample_image)
    print("ğŸ“¸ ØªØµÙˆÛŒØ± Ù†Ù…ÙˆÙ†Ù‡ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯.")

"""## 3. Ø¨Ø®Ø´ Ø³ÙˆÙ…: Ø³ÛŒØ³ØªÙ… Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù…Ø³Ø§Ø¨Ù‚Ø§Øª"""

import pandas as pd
import numpy as np
from sklearn.ensemble import GradientBoostingClassifier
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score, classification_report
import joblib
from datetime import datetime

class WushuMatchPredictor:
    """
    Ø³ÛŒØ³ØªÙ… Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù†ØªØ§ÛŒØ¬ Ù…Ø³Ø§Ø¨Ù‚Ø§Øª ÙˆÙˆØ´Ùˆ
    """
    def __init__(self):
        self.model = None
        self.scaler = StandardScaler()
        self.features = [
            'age', 'weight', 'height', 'experience_years',
            'win_rate', 'avg_match_duration', 'stamina_index',
            'technical_skill', 'mental_toughness', 'recent_form',
            'opponent_age', 'opponent_weight', 'opponent_height',
            'opponent_experience', 'opponent_win_rate',
            'weight_diff', 'height_diff', 'experience_diff'
        ]
        
    def create_match_dataset(self, n_matches=500):
        """
        Ø§ÛŒØ¬Ø§Ø¯ Ø¯ÛŒØªØ§Ø³Øª Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø¨Ø±Ø§ÛŒ Ø¢Ù…ÙˆØ²Ø´ Ù…Ø¯Ù„
        """
        np.random.seed(42)
        
        matches = []
        
        for i in range(n_matches):
            # Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªØµØ§Ø¯ÙÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ùˆ ÙˆØ±Ø²Ø´Ú©Ø§Ø±
            athlete1 = self._create_random_athlete()
            athlete2 = self._create_random_athlete()
            
            # Ù…Ø­Ø§Ø³Ø¨Ù‡ ØªÙØ§ÙˆØªâ€ŒÙ‡Ø§
            weight_diff = athlete1['weight'] - athlete2['weight']
            height_diff = athlete1['height'] - athlete2['height']
            experience_diff = athlete1['experience_years'] - athlete2['experience_years']
            
            # ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ ØªØ±Ú©ÛŒØ¨ÛŒ
            features = [
                athlete1['age'], athlete1['weight'], athlete1['height'],
                athlete1['experience_years'], athlete1['win_rate'],
                athlete1['avg_match_duration'], athlete1['stamina_index'],
                athlete1['technical_skill'], athlete1['mental_toughness'],
                athlete1['recent_form'],
                athlete2['age'], athlete2['weight'], athlete2['height'],
                athlete2['experience_years'], athlete2['win_rate'],
                weight_diff, height_diff, experience_diff
            ]
            
            # ØªØ¹ÛŒÛŒÙ† Ø¨Ø±Ù†Ø¯Ù‡ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ
            winner = self._simulate_match(athlete1, athlete2)
            
            matches.append(features + [winner])
        
        columns = self.features + ['winner']
        df = pd.DataFrame(matches, columns=columns)
        return df
    
    def _create_random_athlete(self):
        """
        Ø§ÛŒØ¬Ø§Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªØµØ§Ø¯ÙÛŒ Ø¨Ø±Ø§ÛŒ ÛŒÚ© ÙˆØ±Ø²Ø´Ú©Ø§Ø±
        """
        age = np.random.randint(16, 35)
        weight = np.random.uniform(55, 95)
        height = np.random.uniform(160, 190)
        experience_years = np.random.randint(1, 15)
